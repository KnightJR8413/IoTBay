<!--HEADER COPY START HERE-->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IoTBay - Home</title>
    <link rel="stylesheet" href="{{ url_for('serve_css', filename='styles.css')}}">
</head>
<body>
    <div class="navbar">
        <div class="logo">
            <a href="/index">
                <img src="{{ url_for('serve_images', filename='logo.png') }}" width="125px" alt="IoTBay Logo">
            </a>
        </div>
        <nav>  
            <ul>
                <li><a href="/index">Home</a></li>
                <li><a href="/about">About</a></li>
                <li><a href="/products">Products</a></li>
                <li><a href="/contact">Contact</a></li>                
            </ul>
        </nav>
        <div class="icon-buttons">
            <button class="icon-btn" onclick="toggleSearchBar();">
                <img src="{{ url_for('serve_images', filename='search.png') }}" alt="search" class="icon-img">
            </button>
            <button class="icon-btn" onclick="checkLoginAndRedirect();">
                <img src="{{ url_for('serve_images', filename='login.png') }}" alt="login" class="icon-img">
            </button>                
            <button class="icon-btn" onclick="location.href='/shoppingcart';">
                <img src="{{ url_for('serve_images', filename='cart.png') }}" alt="shoppingcart" class="icon-img">
            </button>
        </div>
    </div>

    <div id="search-bar" class="search-bar">
        <input type="text" placeholder="Search products..." id="search-input">
        <button onclick="searchProduct()">Search</button>
        <button onclick="toggleSearchBar()">Close</button>
    </div>

    <script src="{{ url_for('serve_js', filename='script.js') }}"></script>
</body>
</html>
<!--HEADER COPY END HERE-->

<section class="hero">
  <h1>Order Details</h1>
</section>

<main class="order-details">
  <table class="orders-table">
    <thead>
      <tr>
        <th>Product</th>
        <th>Qty</th>
        <th>Unit Price</th>
        <th>Line Total</th>
      </tr>
    </thead>
    <tbody id="details-body"></tbody>
    <tfoot>
      <tr>
        <td colspan="3" style="text-align:right">Total:</td>
        <td id="details-total">$0.00</td>
      </tr>
    </tfoot>
  </table>
</main>

<!--FOOTER COPY Start HERE-->
<div class="footer-newsletter">
    <h2>Get the Latest in Tech News, Deals & Giveaways!</h2>
    <div class="newsletter-form">
        <form>
            <input type="email" placeholder="Only an email away..." required>
            <button type="submit">Sign me up!</button>
        </form>
    </div>
</div>

<div class="footer-links">
    <div class="footer-column">
        <h3>ABOUT</h3>
        <ul>
            <li><a href="/about">About Us</a></li>
            <li><a href="/contact">Contact Us</a></li>
            <li><a href="#">Payment Methods</a></li>
            <li><a href="#">Shipping Methods</a></li>
        </ul>
    </div>
    <div class="footer-column">
        <h3>HELP</h3>
        <ul>
            <li><a href="#">FAQ</a></li>
            <li><a href="#">Support</a></li>
            <li><a href="#">Warranty & Returns</a></li>
            <li><a href="#">Services</a></li>
        </ul>
    </div>
    <div class="footer-column">
        <h3>OTHER</h3>
        <ul>
            <li><a href="#">Announcements</a></li>
            <li><a href="#">Careers at IoTBay</a></li>
            <li><a href="/termconditions">Terms & Conditions</a></li>
            <li><a href="/privacypolicy">Privacy Policy</a></li>
        </ul>
    </div>

<div class="footer-column">
<h3>Need advice?</h3>
<p style="color: white"> Speak to our friendly staff</p>
<a href="/contact" class="contact-button">Contact Us</a>
</div>
</div>

<div class="footer-copyright">
<p> Copyright &copy; 1999-2025. IoTBay. ABN #68 345 917 426. All Rights Reserved. All prices include GST.</p>
</div>
</footer>

<div class="subscription-modal">
<div class="modal-content">
<span class="close-modal">&times;</span>
<h3>Thank you for subscribing!</h3>
<p>Your email address <span class="subscribed-email"></span> has been added to the IoTBay mailing list.</p>
</div>
</div>
<div class="modal-backdrop"></div>

<!--FOOTER COPY END HERE-->

<script src="{{ url_for('serve_js',filename:'script.js') }}"></script>
<script>
document.addEventListener('DOMContentLoaded', () => {
  const api = 'http://localhost:3000';
  const params = new URLSearchParams(window.location.search);
  const orderId = params.get('orderId');
  const userId = localStorage.getItem('userId');
  if (!orderId || !userId) return alert('Missing order or not logged in');

  fetch(`${api}/order-history?userId=${userId}`)
    .then(r=>r.json())
    .then(orders => {
      const order = orders.find(o=> String(o.order_id) === orderId);
      if (!order) throw new Error('Order not found');
      const tbody = document.getElementById('details-body');
      let total = 0;
      order.items.forEach(i => {
        const line = i.price * i.quantity;
        total += line;
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${i.name}</td>
          <td>${i.quantity}</td>
          <td>$${i.price.toFixed(2)}</td>
          <td>$${line.toFixed(2)}</td>
        `;
        tbody.appendChild(tr);
      });
      document.getElementById('details-total').textContent = `$${total.toFixed(2)}`;
    })
    .catch(err => {
      console.error(err);
      alert('Could not load order details');
    });
});
</script>
</body>
</html>
